<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Unit One Lessons</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
</head>
<style>
  /* Global Styles */
  body {
    background: linear-gradient(to bottom, #f8f9fa, #e9ecef);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding-bottom: 60px;
  }
  h2, h3 {
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
  }
  /* Navigation Bar */
  .navbar {
    background: linear-gradient(90deg, #0056b3, #007bff);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
  }
  .navbar-brand,
  .nav-link {
    color: #fff !important;
    font-weight: 500;
    transition: color 0.3s ease;
  }
  .nav-link:hover {
    color: #ffc107 !important;
  }
  /* Lesson Container */
  .lesson-container {
    margin-top: 40px;
    display: flex;
    gap: 20px;
    padding: 20px;
  }
  .lesson-video-container {
    flex: 1;
    background: #fff;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    margin-bottom: 20px;
  }
  .lesson-video {
    width: 100%;
    max-width: 800px;
    border-radius: 10px;
    transition: transform 0.3s ease;
  }
  .lesson-video:hover {
    transform: scale(1.02);
  }
  .exercise-container,
  .exam-container {
    flex: 0 0 250px;
    background: #fff;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    max-height: 500px;
    overflow-y: auto;
  }
  .exercise-container h3,
  .exam-container h3 {
    border-bottom: 2px solid #007bff;
    padding-bottom: 10px;
    margin-bottom: 15px;
  }
  .exercise-btn,
  .exam-btn {
    display: block;
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    text-align: center;
    border-radius: 5px;
    color: #fff;
    text-decoration: none;
    transition: background-color 0.3s ease, transform 0.3s ease;
    cursor: pointer;
  }
  .exercise-btn {
    background-color: #007bff;
  }
  .exercise-btn:hover {
    background-color: #0056b3;
    transform: translateY(-3px);
  }
  .exercise-btn.completed {
    background-color: #28a745;
  }
  .exam-btn {
    background-color: #28a745;
  }
  .exam-btn:hover {
    background-color: #1e7e34;
    transform: translateY(-3px);
  }
  /* Next and Back buttons now in normal flow */
  .lesson-video-container .button-group {
    margin-top: 15px;
    display: flex;
    justify-content: space-between;
  }
  /* Footer */
  footer {
    background: #0056b3;
    color: #fff;
    text-align: center;
    padding: 15px 0;
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    box-shadow: 0 -2px 6px rgba(0, 0, 0, 0.2);
  }
  /* Responsive Design */
  @media (max-width: 992px) {
    .lesson-container {
      flex-direction: column;
      align-items: center;
    }
    .exercise-container,
    .exam-container {
      flex: 1 1 100%;
      max-width: 500px;
    }
    .lesson-video-container {
      max-width: 800px;
    }
    .lesson-video-container .button-group {
      flex-direction: column;
      gap: 10px;
    }
  }
</style>
<body>
  <nav class="navbar navbar-expand-lg">
    <div class="container">
      <a class="navbar-brand animate__animated animate__fadeInLeft" href="#">
        <img src="/static/logo.jpeg" alt="Islamic Online" style="height: 40px; margin-right: 10px;">
        Islamic Online
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
              data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
              aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link animate__animated animate__fadeInDown" href="/">Home</a></li>
          <li class="nav-item"><a class="nav-link animate__animated animate__fadeInDown" href="/profile">Student Lesson</a></li>
          <li class="nav-item"><a class="nav-link animate__animated animate__fadeInDown" href="/login">Logout</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container lesson-container">
    <div class="exercise-container">
      <h3>Exercises</h3>
      <a class="exercise-btn" id="ex1" onclick="completeExercise(1)">Multiple Choice</a>
      <a class="exercise-btn" id="ex2" onclick="completeExercise(2)">Matching</a>
      <a class="exercise-btn" id="ex3" onclick="completeExercise(3)">Drag and Drop</a>
    </div>
    
    <div class="lesson-video-container">
      <h2 id="lesson-title">Unit 1 - Lesson 1</h2>
      <video class="lesson-video" controls id="lesson-video">
        <source id="video-source" src="" type="video/mp4">
      </video> 
    
      <!-- Button Group for Back and Next, placed below video -->
      <div class="button-group">
        <button class="btn btn-secondary" id="backBtn" onclick="backLesson()">Back Lesson</button>
        <button class="btn btn-primary" id="nextBtn" onclick="nextLesson()" disabled>Next Lesson</button>

      </div>
    </div>

    <div class="exam-container" id="exam-container">
      <h3>Exams</h3>
      <!-- Midterm buttons-ka had iyo jeer muuqda (green) -->
      <a class="exam-btn" id="midtermOneBtn" href="unit1_midterm1.html">Take Midterm One</a>
      <a class="exam-btn" id="midtermTwoBtn" href="unit1_midterm2.html">Take Midterm Two</a>
      <!-- Final Exam Button (weliga la muujin doono marka casharka ugu dambeeya la gaaro) -->
      <a class="exam-btn" href="quiz_dynamic?finalExam=unit1" id="finalExamBtn" style="display: none;">Take Unit One Final Exam</a>
    </div>
    </div>

  <footer>
    <p>&copy; 2025 Islamic Online. All rights reserved.</p>
  </footer>

  <script>
    let currentLesson = localStorage.getItem("currentLesson") ? parseInt(localStorage.getItem("currentLesson")) : 1;
    const totalLessons = 10;

    function completeExercise(exNumber) {
      localStorage.setItem(`lesson${currentLesson}_ex${exNumber}`, "completed");
      document.getElementById(`ex${exNumber}`).classList.add("completed");
      checkExercises();
      window.location.href = `exercise${exNumber}_lesson${currentLesson}`;
    }

    function checkExercises() {
      let completedCount = 0;
      for (let i = 1; i <= 3; i++) {
        if (localStorage.getItem(`lesson${currentLesson}_ex${i}`)) {
          completedCount++;
        }
      }
      if (completedCount === 3) {
        document.getElementById("nextBtn").removeAttribute("disabled");
      }
    }

    function nextLesson() {
      if (currentLesson === 5 && !localStorage.getItem("midterm1Completed")) {
        alert("Please take Midterm One before proceeding.");
        return;
      }
      if (currentLesson === 8 && !localStorage.getItem("midterm2Completed")) {
        alert("Please take Midterm Two before proceeding.");
        return;
      }
      if (currentLesson < totalLessons) {
        currentLesson++;
        localStorage.setItem("currentLesson", currentLesson);
        updateLesson();
      } else {
        alert("All lessons completed. Please take the Final Exam.");
      }
    }

    function backLesson() {
      if (currentLesson > 1) {
        currentLesson--;
        localStorage.setItem("currentLesson", currentLesson);
        updateLesson();
      } else {
        alert("This is the first lesson.");
      }
    }

    function logout() {
      localStorage.clear();
      window.location.href = "/login";
    }
    

    function takeFinalExam() {
      alert("Final Exam completed! Redirecting to profile...");
      window.location.href = "/profile";
    }

    function updateLesson() {
      document.getElementById("lesson-title").innerText = "Unit 1 - Lesson " + currentLesson;
    
      const videoUrls = {
        1: "/static/videos/unit1/lesson1.mp4",
        2: "/static/videos/unit1/lesson2.mp4",
        3: "/static/videos/unit1/lesson3.mp4",
        4: "/static/videos/unit1/lesson4.mp4",
        5: "/static/videos/unit1/lesson5.mp4",
        6: "/static/videos/unit1/lesson6.mp4",
        7: "/static/videos/unit1/lesson7.mp4",
        8: "/static/videos/unit1/lesson8.mp4",
        9: "/static/videos/unit1/lesson9.mp4",
        10: "/static/videos/unit1/lesson10.mp4"
      };
    
      const videoSource = document.getElementById("video-source");
      const lessonVideo = document.getElementById("lesson-video");
    
      videoSource.src = videoUrls[currentLesson];
      lessonVideo.load();
    
      // check exercises status
      checkExercises();
    
      // handle final exam visibility
      if (currentLesson === totalLessons) {
        document.getElementById("finalExamBtn").style.display = "block";
      } else {
        document.getElementById("finalExamBtn").style.display = "none";
      }
    
      // handle midterm visibility
      if (currentLesson === 5 && !localStorage.getItem("midterm1Completed")) {
        document.getElementById("midtermOneBtn").style.display = "block";
      } else if (currentLesson > 5) {
        document.getElementById("midtermOneBtn").style.display = "none";
      }
    
      if (currentLesson === 8 && !localStorage.getItem("midterm2Completed")) {
        document.getElementById("midtermTwoBtn").style.display = "block";
      } else if (currentLesson > 8) {
        document.getElementById("midtermTwoBtn").style.display = "none";
      }
    }
    
    // Si sax ah casharka loogu soo bilaabo markii page-ka furmo
    document.addEventListener("DOMContentLoaded", () => {
      currentLesson = localStorage.getItem("currentLesson") ? parseInt(localStorage.getItem("currentLesson")) : 1;
      updateLesson();
      checkExercises();
    });
    

  </script>
</body>
</html>
